# 📦 打包指南

## 🚀 快速打包

### 方式一：推荐 - 文件夹模式（启动快）

```bash
双击运行：build_exe.bat
```

**优点：**
- ✅ 启动速度快
- ✅ 运行稳定
- ✅ 文件体积较小

**输出：**
- `dist\图片批处理工具\` 文件夹
- 将整个文件夹发送给朋友
- 朋友双击文件夹内的 `图片批处理工具.exe` 运行

---

### 方式二：单文件模式（便于分发）

```bash
双击运行：build_exe_onefile.bat
```

**优点：**
- ✅ 只有一个 exe 文件
- ✅ 便于分发

**缺点：**
- ⚠️ 首次启动较慢（需要解压临时文件）
- ⚠️ 文件体积较大

**输出：**
- `dist\图片批处理工具.exe` 单个文件
- 直接发送 exe 文件给朋友
- 朋友双击即可运行

---

## 📋 打包步骤详解

### 1. 准备工作

确保已安装依赖：
```bash
pip install -r requirements.txt
pip install pyinstaller
```

### 2. 执行打包

运行打包脚本：
```bash
build_exe.bat          # 推荐，文件夹模式
# 或
build_exe_onefile.bat  # 单文件模式
```

### 3. 打包产物

**文件夹模式：**
```
dist/
└── 图片批处理工具/
    ├── 图片批处理工具.exe     ← 主程序
    ├── _internal/              ← 依赖文件
    └── ... (其他依赖库)
```

**单文件模式：**
```
dist/
└── 图片批处理工具.exe         ← 单个文件
```

### 4. 发送给朋友

**文件夹模式：**
1. 压缩整个 `dist\图片批处理工具\` 文件夹
2. 发送压缩包
3. 朋友解压后双击 `图片批处理工具.exe`

**单文件模式：**
1. 直接发送 `dist\图片批处理工具.exe`
2. 朋友双击即可运行

---

## ⚙️ 高级配置

### 手动打包命令

如果需要自定义打包选项：

```bash
# 激活虚拟环境
.venv\Scripts\activate

# 文件夹模式
pyinstaller --onedir --windowed --name "图片批处理工具" ^
    --add-data ".venv/Lib/site-packages/customtkinter;customtkinter/" ^
    --hidden-import=PIL --hidden-import=customtkinter ^
    --collect-data customtkinter ^
    image_processor.py

# 单文件模式
pyinstaller --onefile --windowed --name "图片批处理工具" ^
    --add-data ".venv/Lib/site-packages/customtkinter;customtkinter/" ^
    --hidden-import=PIL --hidden-import=customtkinter ^
    --collect-data customtkinter ^
    image_processor.py
```

### 添加图标

1. 准备一个 `.ico` 文件（推荐 256x256）
2. 修改打包脚本，将 `--icon=NONE` 改为 `--icon=your_icon.ico`

---

## 🐛 常见问题

### Q1: 打包失败，提示找不到模块

**解决：** 检查虚拟环境是否激活
```bash
.venv\Scripts\activate
pip list  # 查看已安装的包
```

### Q2: exe 运行时闪退

**解决：** 
1. 用命令行运行 exe，查看错误信息
2. 检查是否缺少依赖库
3. 尝试添加 `--hidden-import=模块名`

### Q3: exe 体积太大

**原因：** PyInstaller 会打包所有依赖

**解决：**
- 使用文件夹模式（体积更小）
- 或使用 UPX 压缩：`pip install pyinstaller[upx]`

### Q4: 首次启动很慢

**原因：** 单文件模式需要解压临时文件

**解决：** 使用文件夹模式（`build_exe.bat`）

### Q5: 杀毒软件报毒

**原因：** PyInstaller 打包的 exe 可能被误报

**解决：**
1. 添加到白名单
2. 或使用代码签名证书
3. 向杀毒软件厂商报告误报

---

## 📊 对比表

| 特性 | 文件夹模式 | 单文件模式 |
|------|-----------|-----------|
| 启动速度 | ⚡ 快 | 🐌 慢 |
| 文件数量 | 📁 多个文件 | 📄 单个文件 |
| 分发便利性 | 🔄 需压缩 | ✉️ 直接发送 |
| 文件大小 | 📦 较小 | 📦 较大 |
| 稳定性 | ✅ 高 | ⚠️ 中 |
| 推荐度 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |

---

## 💡 最佳实践

1. **开发阶段**：使用 Python 直接运行
2. **测试打包**：先用文件夹模式测试
3. **正式发布**：
   - 团队内部：文件夹模式
   - 公开分发：根据需求选择

---

## 📝 版本信息

- PyInstaller 版本：6.0+
- Python 版本：3.8+
- 支持系统：Windows 10/11

---

**打包完成后，记得测试一下 exe 是否能正常运行！** 🎉
